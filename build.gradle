defaultTasks 'dist'

subprojects {
    apply plugin: 'java'
    
	sourceCompatibility = 7
	
	repositories {
		mavenCentral()
	}
	
	dependencies {
		testCompile group: 'junit', name: 'junit', version: '4.+'
	}

	sourceSets {
		main { java { srcDir 'src' } }
		test { java { srcDir 'test' } }
	}

	jar {
		from 'license.txt'
	}
}

project(':utils-base') {
    dependencies {
        compile project(':utils-kernel')
    }
}

project(':utils-graphics') {
    dependencies {
        compile project(':utils-base'), project(':utils-math'), project(':utils-pdlib')
    }
}

project(':utils-lang') {
    dependencies {
        compile project(':utils-base'), project(':utils-xml')
    }
}

project(':utils-pdlib') {
    dependencies {
        compile project(':utils-kernel')
    }
}

project(':utils-serialize') {
    dependencies {
        compile project(':utils-math'), project(':utils-xml')
    }
}

project(':utils-swing') {
    dependencies {
        compile project(':utils-graphics')
    }
}

project(':utils-xml') {
    dependencies {
        compile project(':utils-base')
    }
}

task clean << {
	delete "build", "dist"
}

task dist(type: Zip, dependsOn: subprojects*.build) {
	subprojects.each() { subproject ->
		ext.jarDir = "${subproject.name}/build/libs/"
		from (zipTree(ext.jarDir + subproject.name + ".jar")) { exclude 'license.txt' }
		from (zipTree(ext.jarDir + subproject.name + ".jar")) { include 'license.txt' into("licenses/${subproject.name}/") }
	};
	from 'license.txt'
    destinationDir = file("dist")
    archiveName = 'utils.jar'
}


